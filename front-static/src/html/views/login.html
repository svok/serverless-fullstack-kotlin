<%
var data = {
title: "Sign in",
author: "svok"
};
var header = require('html-loader!./../includes/header.html');
var footer = require('html-loader!./../includes/footer.html');
%><%= _.template(header)(data) %>
    <script src="js/login-bundle.js"></script>

<div class="container">
    <form>
        <h1>Please sign in</h1>

        <input type="text" id="inputUsername" placeholder="Email address" name="username" required autofocus>
        <input type="password" id="inputPassword" placeholder="Password" name="password" required>
        <button type="button" onclick="signInButton()">Sign in</button>

    </form>


    <script>
        $(document).ready(function(){
            console.log("Document is ready");
        });
        function signInButton() {

            var authenticationData = {
                Username: document.getElementById("inputUsername").value,
                Password: document.getElementById("inputPassword").value,
            };

            var authenticationDetails = new AmazonCognitoIdentity.AuthenticationDetails(authenticationData);

            var poolData = {
                UserPoolId: _config.cognito.userPoolId, // Your user pool id here
                ClientId: _config.cognito.clientId, // Your client id here
            };

            var userPool = new AmazonCognitoIdentity.CognitoUserPool(poolData);

            var userData = {
                Username: document.getElementById("inputUsername").value,
                Pool: userPool,
            };

            var cognitoUser = new AmazonCognitoIdentity.CognitoUser(userData);

            cognitoUser.authenticateUser(authenticationDetails, {
                onSuccess: function (result) {
                    var accessToken = result.getAccessToken().getJwtToken();
                    console.log(accessToken);
                },
                onFailure: function (err) {
                    alert(err.message || JSON.stringify(err));
                },
            });
        }
    </script>
</div>

<%= _.template(footer)(data) %>
